<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zuckabot Claim Portal</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.11.1/dist/ethers.umd.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; color: #222; margin:0; padding:0; }
    header { background:#111; color:#fff; padding:1rem; text-align:center; }
    main { max-width:600px; margin:2rem auto; background:#fff; padding:2rem; border-radius:12px; box-shadow:0 4px 8px rgba(0,0,0,0.1); }
    button { background:#0066ff; color:#fff; border:none; padding:0.75rem 1.5rem; border-radius:8px; margin:0.5rem 0; cursor:pointer; font-size:1rem; }
    button:hover { background:#004ccc; }
    .address-box { background:#eee; padding:0.5rem; border-radius:6px; font-family:monospace; display:flex; justify-content:space-between; align-items:center; }
    .copy-btn { background:#ccc; color:#111; border:none; padding:0.3rem 0.6rem; font-size:0.8rem; border-radius:4px; cursor:pointer; }
    .faq-item { margin-bottom:1rem; }
    .faq-q { font-weight:bold; cursor:pointer; }
    .faq-a { display:none; padding:0.5rem; background:#f9f9f9; border-radius:6px; }
  </style>
</head>
<body>
  <header>
    <h1>Zuckabot Claim Portal</h1>
  </header>
  <main>
    <button onclick="connectWallet()">ðŸ”— Connect Wallet</button>
    <div id="walletInfo"></div>

    <h2>Claim Process</h2>
    <button onclick="initiateClaim()">ðŸš€ Initiate Claim</button>
    <button onclick="finalizeClaim()">âœ… Finalize Claim</button>

    <h2>Your Balance</h2>
    <div id="balanceBox">Connect wallet to see balance.</div>

    <h2>Contracts</h2>
    <div class="address-box">Token: 0x54bff3901d7d27ffe21b9a23bc8efb48c9847048 
      <button class="copy-btn" onclick="copyAddress('0x54bff3901d7d27ffe21b9a23bc8efb48c9847048')">Copy</button>
    </div>
    <div class="address-box">Distributor: 0xec222Dba73C17877773E411D15904bf205FbA149 
      <button class="copy-btn" onclick="copyAddress('0xec222Dba73C17877773E411D15904bf205FbA149')">Copy</button>
    </div>
    <div class="address-box">Treasury: 0x42e8D84Ff8ff8e5EaE8E2648Ebfa772ee4515c91 
      <button class="copy-btn" onclick="copyAddress('0x42e8D84Ff8ff8e5EaE8E2648Ebfa772ee4515c91')">Copy</button>
    </div>

    <h2>FAQ</h2>
    <div class="faq-item">
      <div class="faq-q" onclick="toggleFaq(this)">Why is there a $0.25 claim fee?</div>
      <div class="faq-a">To prevent bot abuse and cover gas + liquidity setup. It is dynamically calculated in BNB at live price.</div>
    </div>
    <div class="faq-item">
      <div class="faq-q" onclick="toggleFaq(this)">Can I claim twice?</div>
      <div class="faq-a">No, each unique wallet can only claim once. Duplicate claims are blocked on-chain.</div>
    </div>
    <div class="faq-item">
      <div class="faq-q" onclick="toggleFaq(this)">When will Zuckabot launch?</div>
      <div class="faq-a">Target listing at $0.05 per token on PancakeSwap after distribution ends.</div>
    </div>
  </main>

  <script>
    const tokenCA = "0x54bff3901d7d27ffe21b9a23bc8efb48c9847048";
    const distributorCA = "0xec222Dba73C17877773E411D15904bf205FbA149";

    const tokenABI = [...]; // paste your full token ABI here
    const distributorABI = [...]; // paste your full distributor ABI here

    let provider, signer, distributorContract, tokenContract, userAddress;

    async function connectWallet() {
      try {
        if (!window.ethereum) {
          alert("Please install MetaMask or use a Web3 wallet.");
          return;
        }
        provider = new ethers.BrowserProvider(window.ethereum);
        signer = await provider.getSigner();
        userAddress = await signer.getAddress();

        tokenContract = new ethers.Contract(tokenCA, tokenABI, signer);
        distributorContract = new ethers.Contract(distributorCA, distributorABI, signer);

        document.getElementById("walletInfo").innerText = "Connected: " + userAddress;
        loadBalance();
      } catch (err) {
        console.error("connectWallet error:", err);
        alert("Wallet connection failed.");
      }
    }

    async function loadBalance() {
      try {
        const bal = await tokenContract.balanceOf(userAddress);
        const decimals = await tokenContract.decimals();
        const formatted = ethers.formatUnits(bal, decimals);

        // USD value at $0.05 launch price
        const usdVal = (parseFloat(formatted) * 0.05).toFixed(2);

        document.getElementById("balanceBox").innerText = `${formatted} ZUCKA (~$${usdVal} at launch)`;
      } catch (err) {
        console.error("loadBalance error:", err);
      }
    }

    async function initiateClaim() {
      try {
        const tx = await distributorContract.initiateClaim();
        await tx.wait();
        alert("Claim initiated. Please wait the required time before finalizing.");
      } catch (err) {
        console.error("initiateClaim error:", err);
        alert("Error initiating claim: " + (err?.reason || err.message));
      }
    }

    async function finalizeClaim() {
      try {
        const requiredWei = await distributorContract.requiredClaimWei();
        const tx = await distributorContract.finalizeClaim({ value: requiredWei });
        await tx.wait();
        alert("Claim finalized successfully! ZUCKA tokens sent.");
        loadBalance();
      } catch (err) {
        console.error("finalizeClaim error:", err);
        alert("Error finalizing claim: " + (err?.reason || err.message));
      }
    }

    function copyAddress(addr) {
      navigator.clipboard.writeText(addr);
      alert("Copied: " + addr);
    }

    function toggleFaq(el) {
      const ans = el.nextElementSibling;
      ans.style.display = ans.style.display === "block" ? "none" : "block";
    }
  </script>
</body>
</html>
